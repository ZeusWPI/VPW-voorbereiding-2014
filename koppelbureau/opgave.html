        <p style="text-align: justify;">Een koppelbureau wil $n$ mannen $m_0, m_1, \ldots, m_{n-1}$ koppelen aan $n$ vrouwen $v_0, v_1, \ldots, v_{n-1}$. Aan elke man en elke vrouw werd gevraagd om alle kandidaten van het andere geslacht te rangschikken naar persoonlijke voorkeur. Deze voorkeuren van de mannen en de vrouwen kunnen voorgesteld worden in twee $n \times n$ tabellen. Hierbij geeft de eerste rij van de tabel met de voorkeur van de mannen bijvoorbeeld de rangschikking van man $m_0$ aan, waarbij een waarde $i$ ($0 \leq i &lt; n$) in de eerste kolom aangeeft dat de eerste keuze van man $m_0$ uitgaat naar vrouw $v_i$. Een waarde $j$ ($0 \leq j &lt; n$) in de tweede kolom geeft analoog aan dat de tweede keuze van man $m_0$ uitgaat naar vrouw $v_j$. Op dezelfde manier geeft de tweede rij de rangschikking van de vrouwen zoals die werd opgesteld door man $m_1$. De tabel met de voorkeur van de vrouwen is op dezelfde manier opgebouwd.</p>
        <p style="text-align: justify;">Hieronder staan bijvoorbeeld de tabellen met de voorkeuren voor 4 mannen en 4 vrouwen, waarbij de kandidaten van beide groepen gelabeld worden met de getallen 0, 1, 2, en 3.</p>
        <div style="text-align:center;">
          <div style="display: inline-block; vertical-align: middle;">
            <table class="problems" style="width: auto; margin-right: 60px;"
              border="0">
              <tbody>
                <tr class="headerrow">
                  <th colspan="5">voorkeur mannen</th>
                </tr>
                <tr class="problemrow">
                  <td style="border-right: 1px; border-style:solid; border-color: #000000">0</td>
                  <td>1</td>
                  <td>0</td>
                  <td>2</td>
                  <td>3</td>
                </tr>
                <tr class="problemrow">
                  <td style="border-right: 1px; border-style:solid; border-color: #000000">1</td>
                  <td>3</td>
                  <td>0</td>
                  <td>1</td>
                  <td>2</td>
                </tr>
                <tr class="problemrow">
                  <td style="border-right: 1px; border-style:solid; border-color: #000000">2</td>
                  <td>0</td>
                  <td>2</td>
                  <td>1</td>
                  <td>3</td>
                </tr>
                <tr class="problemrow">
                  <td style="border-right: 1px; border-style:solid; border-color: #000000">3</td>
                  <td>1</td>
                  <td>2</td>
                  <td>0</td>
                  <td>3</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div style="display: inline-block; vertical-align: middle;">
            <table class="problems" style="width: auto;" border="0">
              <tbody>
                <tr class="headerrow">
                  <th colspan="5">voorkeur vrouwen</th>
                </tr>
                <tr class="problemrow">
                  <td style="border-right: 1px; border-style:solid; border-color: #000000">0</td>
                  <td>0</td>
                  <td>2</td>
                  <td>1</td>
                  <td>3</td>
                </tr>
                <tr class="problemrow">
                  <td style="border-right: 1px; border-style:solid; border-color: #000000">1</td>
                  <td>2</td>
                  <td>3</td>
                  <td>0</td>
                  <td>1</td>
                </tr>
                <tr class="problemrow">
                  <td style="border-right: 1px; border-style:solid; border-color: #000000">2</td>
                  <td>3</td>
                  <td>1</td>
                  <td>2</td>
                  <td>0</td>
                </tr>
                <tr class="problemrow">
                  <td style="border-right: 1px; border-style:solid; border-color: #000000">3</td>
                  <td>2</td>
                  <td>1</td>
                  <td>0</td>
                  <td>3</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <p style="text-align: justify;">Uit voorgaande tabellen leiden we bijvoorbeeld af dat de eerste keuze van man $m_0$ uitgaat naar vrouw $v_1$, terwijl man $m_0$ zelf slechts de derde keuze is van vrouw $v_1$.</p>
        <p style="text-align: justify;">Rekening houdend met de persoonlijke voorkeuren wil het koppelbureau de mannen en de vrouwen paarsgewijs aan elkaar koppelen. Ze willen dit echter op zo'n manier doen dat geen enkele man en geen enkele vrouw liever elkaar zouden hebben dan de partner waaraan ze gekoppeld werden. Indien dit lukt, dan is de kans immers zeer groot dat dit zal leiden tot <a
            href="http://mathsite.math.berkeley.edu/smp/smp.html" target="_blank">stabiele huwelijken</a>. Voor een zeer welsprekende uiteenzetting van het <a
            href="http://en.wikipedia.org/wiki/Stable_marriage_problem"
            target="_blank"><em>stable marriage problem</em></a> en bijkomende achtergrondinformatie verwijzen we naar <a
            href="http://www.cs.columbia.edu/%7Eevs/intro/stable/writeup.html"
            target="_blank">dit</a> artikel.</p>
        <h3>Algoritme</h3>
        <p style="text-align: justify;">In 1962 bewezen David Gale en Lloyd Shapley dat het voor een gelijk aantal mannen en vrouwen altijd mogelijk is om een stabiele oplossing te vinden voor het bovenstaande probleem<a
            href="http://en.wikipedia.org/wiki/Stable_marriage_problem"
            target="_blank"><em>&nbsp;</em></a>. Ze gaven daarbij ook een algoritme om de oplossing te vinden. Dit Gale-Shapley algoritme kan als volgt omschreven worden:</p>
        <div class="hlcode">
          <div class="syntax">
            <pre>initieel zijn alle mannen en vrouwen nog vrij (niet gekoppeld)
zolang er nog een man m is die niet aan een vrouw gekoppeld is
    zoek eerst gerangschikte vrouw v die man m nog niet heeft aangezocht (*)
    als vrouw v nog niet gekoppeld is aan een man
        koppel dan man m aan vrouw v
    anders is vrouw v reeds gekoppeld aan mannelijke concurrent c
        als vrouw v man m verkiest boven man c
            koppel dan man m aan vrouw v
            man c is terug een vrij man
        anders blijft vrouw v aan man c gekoppeld
</pre>
          </div>
        </div>
        <p style="text-align: justify;">Gale en Shapley toonden ook aan dat er op punt (*) van het algoritme gegarandeerd steeds een vrouw $v$ is waaraan de vrije man $m$ nog geen aanzoek gedaan heeft.</p>
        <p style="text-align: justify;">Voor de bovenstaande voorkeurstabellen doorloopt het algoritme de volgende stappen:</p>
        <ul>
          <li> iteratie 1: man 0 kiest vrouw 1 (zijn eerste keuze)</li>
          <li> iteratie 2: man 1 kiest vrouw 3 (zijn eerste keuze)</li>
          <li> iteratie 3: man 2 kiest vrouw 0 (zijn eerste keuze)</li>
          <li> iteratie 4: man 3 kiest vrouw 1 (zijn eerste keuze), want vrouw 1 verkiest man 3 boven man 0; man 0 is terug vrij</li>
          <li> iteratie 5: man 0 kiest vrouw 0 (zijn tweede keuze), want vrouw 0 verkiest man 0 boven man 2; man 2 is terug vrij</li>
          <li> iteratie 6: man 2 kiest vrouw 2 (zijn tweede keuze)</li>
          <li> alle vrouwen zijn nu aan mannen gekoppeld
            <ul>
              <li> man 0 $\rightarrow$ vrouw 0</li>
              <li> man 1 $\rightarrow$ vrouw 3</li>
              <li> man 2 $\rightarrow$ vrouw 2</li>
              <li> man 3 $\rightarrow$ vrouw 1</li>
            </ul>
          </li>
        </ul>
        <h3>Opgave</h3>
        <p style="text-align: justify;">Schrijf een functie <span style="font-family: monospace;">koppelbureau</span> die het Gale-Shapley algoritme implementeert. Aan deze functie moeten twee parameters doorgegeven worden: de voorkeur van de mannen en de voorkeur van de vrouwen. Elk van deze parameters moet doorgegeven worden als een lijst van lijsten van gehele getallen, waarbij de binnenste lijsten telkens een rangschikking van de waarden $0, 1, \ldots, n-1$ weergeven. De functie moet als resultaat een tuple van koppels (tuple met twee natuurlijke getallen) teruggeven, waarbij het eerste element van elk koppel telkens het label van de man aangeeft en het tweede element het label van de vrouw die aan de man gekoppeld werd. De koppels moeten gerangschikt worden volgens oplopende labels van de mannen.</p>
        <h3>Voorbeeld</h3>
        <div class="hlcode">
          <div class="syntax">
            <pre><span class="gp">&gt;&gt;&gt; </span><span class="n">koppelbureau</span><span
class="p">(</span>
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">1</span><span
class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span
class="p">],</span> <span class="p">[</span><span class="mi">3</span><span
class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span
class="p">],</span> <span class="p">[</span><span class="mi">0</span><span
class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span
class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span
class="p">],</span> <span class="p">[</span><span class="mi">1</span><span
class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span
class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span
class="p">]],</span> 
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">0</span><span
class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span
class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span
class="p">],</span> <span class="p">[</span><span class="mi">2</span><span
class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span
class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span
class="p">],</span> <span class="p">[</span><span class="mi">3</span><span
class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span
class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span
class="p">],</span> <span class="p">[</span><span class="mi">2</span><span
class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span
class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span
class="p">]]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">((0, 0), (1, 3), (2, 2), (3, 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">koppelbureau</span><span
class="p">(</span>
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">0</span><span
class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span
class="mi">1</span><span class="p">],</span> <span class="p">[</span><span
class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span
class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span
class="p">[</span><span class="mi">1</span><span class="p">,</span> <span
class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span
class="p">]],</span> 
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">2</span><span
class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span
class="mi">0</span><span class="p">],</span> <span class="p">[</span><span
class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span
class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span
class="p">[</span><span class="mi">1</span><span class="p">,</span> <span
class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span
class="p">]]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">((0, 2), (1, 0), (2, 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">koppelbureau</span><span
class="p">(</span>
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">0</span><span
class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span
class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span
class="p">],</span> <span class="p">[</span><span class="mi">2</span><span
class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span
class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span
class="p">],</span> <span class="p">[</span><span class="mi">0</span><span
class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span
class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span
class="p">],</span> <span class="p">[</span><span class="mi">1</span><span
class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span
class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span
class="p">]],</span> 
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">1</span><span
class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span
class="p">],</span> <span class="p">[</span><span class="mi">0</span><span
class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span
class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span
class="p">],</span> <span class="p">[</span><span class="mi">3</span><span
class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span
class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span
class="p">],</span> <span class="p">[</span><span class="mi">1</span><span
class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span
class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span
class="p">]]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">((0, 0), (1, 2), (2, 3), (3, 1))</span>
</pre>
          </div>
        </div>
        <p style="text-align: justify;">Het eerste voorbeeld correspondeert met de voorkeurstabellen die hierboven als voorbeeld werden gegeven. De oplossing voor deze tabellen wordt hieronder grafisch weergegeven.</p>
        <div style="text-align:center;"><a class="highslide" onclick="return hs.expand(this, { outlineType: 'rounded-white' })"
            href="http://www.pythia.ugent.be/spoj/files/stabiel_huwelijk.png"><img
              title="stabiel huwelijk" src="http://www.pythia.ugent.be/spoj/files/stabiel_huwelijk.png"
              alt="stabiel huwelijk" height="220"></a>
          <div class="highslide-caption">voorbeeld van een stabiel huwelijk</div>
        </div>